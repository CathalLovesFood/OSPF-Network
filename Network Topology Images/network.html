<html>
    <head>
        <meta charset="utf-8">
        
            <script src="lib/bindings/utils.js"></script>
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/vis-network/9.1.2/dist/dist/vis-network.min.css" integrity="sha512-WgxfT5LWjfszlPHXRmBWHkV2eceiWTOBvrKCNbdgDYTHrT2AeLCGbF4sZlZw3UMN3WtL0tGUoIAKsu8mllg/XA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
            <script src="https://cdnjs.cloudflare.com/ajax/libs/vis-network/9.1.2/dist/vis-network.min.js" integrity="sha512-LnvoEWDFrqGHlHmDD2101OrLcbsfkrzoSpvtSQtxK3RMnRV0eOkhhBN2dXHKRrUU8p2DGRTk35n4O8nWSVe1mQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
            
        
<center>
<h1></h1>
</center>

<!-- <link rel="stylesheet" href="../node_modules/vis/dist/vis.min.css" type="text/css" />
<script type="text/javascript" src="../node_modules/vis/dist/vis.js"> </script>-->
        <link
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6"
          crossorigin="anonymous"
        />
        <script
          src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
          integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
          crossorigin="anonymous"
        ></script>


        <center>
          <h1></h1>
        </center>
        <style type="text/css">

             #mynetwork {
                 width: 100%;
                 height: 750px;
                 background-color: #ffffff;
                 border: 1px solid lightgray;
                 position: relative;
                 float: left;
             }

             

             

             
        </style>
    </head>


    <body>
        <div class="card" style="width: 100%">
            
            
            <div id="mynetwork" class="card-body"></div>
        </div>

        
        

        <script type="text/javascript">

              // initialize global variables.
              var edges;
              var nodes;
              var allNodes;
              var allEdges;
              var nodeColors;
              var originalNodes;
              var network;
              var container;
              var options, data;
              var filter = {
                  item : '',
                  property : '',
                  value : []
              };

              

              

              // This method is responsible for drawing the graph, returns the drawn network
              function drawGraph() {
                  var container = document.getElementById('mynetwork');

                  

                  // parsing and collecting nodes and edges from the python
                  nodes = new vis.DataSet([{"color": "#97c2fc", "font": {"color": "black"}, "id": "0", "image": "/home/cathal-moran/Documents/Random-Network-Generator/Node Images/Routers/Router/Router.png", "label": "0", "name": "CoreRouter1", "shape": "image", "title": "CoreRouter1 (router)"}, {"color": "#97c2fc", "font": {"color": "black"}, "id": "1", "image": "/home/cathal-moran/Documents/Random-Network-Generator/Node Images/Routers/Router/Router.png", "label": "1", "name": "CoreRouter2", "shape": "image", "title": "CoreRouter2 (router)"}, {"color": "#97c2fc", "font": {"color": "black"}, "id": "2", "image": "/home/cathal-moran/Documents/Random-Network-Generator/Node Images/Routers/Router/Router.png", "label": "2", "name": "CoreRouter3", "shape": "image", "title": "CoreRouter3 (router)"}, {"color": "#97c2fc", "font": {"color": "black"}, "id": "3", "image": "/home/cathal-moran/Documents/Random-Network-Generator/Node Images/Routers/Router/Router.png", "label": "3", "name": "CoreRouter4", "shape": "image", "title": "CoreRouter4 (router)"}, {"color": "#97c2fc", "font": {"color": "black"}, "id": "4", "image": "/home/cathal-moran/Documents/Random-Network-Generator/Node Images/Firewalls/Palo Alot/PaloAlto.png", "label": "4", "name": "Firewall1", "shape": "image", "title": "Firewall1 (firewall)"}, {"color": "#97c2fc", "font": {"color": "black"}, "id": "5", "image": "/home/cathal-moran/Documents/Random-Network-Generator/Node Images/Firewalls/Palo Alot/PaloAlto.png", "label": "5", "name": "Firewall2", "shape": "image", "title": "Firewall2 (firewall)"}, {"color": "#97c2fc", "font": {"color": "black"}, "id": "6", "image": "/home/cathal-moran/Documents/Random-Network-Generator/Node Images/Firewalls/Palo Alot/PaloAlto.png", "label": "6", "name": "Firewall3", "shape": "image", "title": "Firewall3 (firewall)"}, {"color": "#97c2fc", "font": {"color": "black"}, "id": "7", "image": "/home/cathal-moran/Documents/Random-Network-Generator/Node Images/Routers/Router/Router.png", "label": "7", "name": "EdgeRouter1", "shape": "image", "title": "EdgeRouter1 (router)"}, {"color": "#97c2fc", "font": {"color": "black"}, "id": "8", "image": "/home/cathal-moran/Documents/Random-Network-Generator/Node Images/Switches/Cisco/Switch/CiscoSwitch.png", "label": "8", "name": "Switch8", "shape": "image", "title": "Switch8 (switch)"}, {"color": "#97c2fc", "font": {"color": "black"}, "id": "9", "image": "/home/cathal-moran/Documents/Random-Network-Generator/Node Images/Hosts/Hosts.png", "label": "9", "name": "Host9", "shape": "image", "title": "Host9 (host)"}, {"color": "#97c2fc", "font": {"color": "black"}, "id": "10", "image": "/home/cathal-moran/Documents/Random-Network-Generator/Node Images/Routers/Router/Router.png", "label": "10", "name": "EdgeRouter2", "shape": "image", "title": "EdgeRouter2 (router)"}, {"color": "#97c2fc", "font": {"color": "black"}, "id": "11", "image": "/home/cathal-moran/Documents/Random-Network-Generator/Node Images/Switches/Cisco/Switch/CiscoSwitch.png", "label": "11", "name": "Switch11", "shape": "image", "title": "Switch11 (switch)"}, {"color": "#97c2fc", "font": {"color": "black"}, "id": "12", "image": "/home/cathal-moran/Documents/Random-Network-Generator/Node Images/Hosts/Hosts.png", "label": "12", "name": "Host12", "shape": "image", "title": "Host12 (host)"}, {"color": "#97c2fc", "font": {"color": "black"}, "id": "13", "image": "/home/cathal-moran/Documents/Random-Network-Generator/Node Images/Routers/Router/Router.png", "label": "13", "name": "EdgeRouter3", "shape": "image", "title": "EdgeRouter3 (router)"}, {"color": "#97c2fc", "font": {"color": "black"}, "id": "14", "image": "/home/cathal-moran/Documents/Random-Network-Generator/Node Images/Switches/Cisco/Switch/CiscoSwitch.png", "label": "14", "name": "Switch14", "shape": "image", "title": "Switch14 (switch)"}, {"color": "#97c2fc", "font": {"color": "black"}, "id": "15", "image": "/home/cathal-moran/Documents/Random-Network-Generator/Node Images/Hosts/Hosts.png", "label": "15", "name": "Host15", "shape": "image", "title": "Host15 (host)"}, {"color": "#97c2fc", "font": {"color": "black"}, "id": "16", "image": "/home/cathal-moran/Documents/Random-Network-Generator/Node Images/Hosts/Hosts.png", "label": "16", "name": "Host16", "shape": "image", "title": "Host16 (host)"}, {"color": "#97c2fc", "font": {"color": "black"}, "id": "17", "image": "/home/cathal-moran/Documents/Random-Network-Generator/Node Images/Hosts/Hosts.png", "label": "17", "name": "Host17", "shape": "image", "title": "Host17 (host)"}, {"color": "#97c2fc", "font": {"color": "black"}, "id": "18", "image": "/home/cathal-moran/Documents/Random-Network-Generator/Node Images/Hosts/Hosts.png", "label": "18", "name": "Host18", "shape": "image", "title": "Host18 (host)"}]);
                  edges = new vis.DataSet([{"from": "0", "ip_label": "10.0.0.0/30", "label": "", "port_label": "e0/0 - e0/0", "title": "10.0.0.0/30\n10.0.0.1 \u003c-\u003e 10.0.0.2", "to": "1"}, {"from": "0", "ip_label": "10.0.0.4/30", "label": "", "port_label": "e0/1 - e0/0", "title": "10.0.0.4/30\n10.0.0.5 \u003c-\u003e 10.0.0.6", "to": "3"}, {"from": "0", "ip_label": "172.16.0.0/30", "label": "", "port_label": "e0/2 - e0/0", "title": "172.16.0.0/30\n172.16.0.1 \u003c-\u003e 172.16.0.2", "to": "5"}, {"from": "1", "ip_label": "10.0.0.8/30", "label": "", "port_label": "e0/1 - e0/0", "title": "10.0.0.8/30\n10.0.0.9 \u003c-\u003e 10.0.0.10", "to": "2"}, {"from": "1", "ip_label": "172.16.0.4/30", "label": "", "port_label": "e0/2 - e0/0", "title": "172.16.0.4/30\n172.16.0.5 \u003c-\u003e 172.16.0.6", "to": "4"}, {"from": "2", "ip_label": "10.0.0.12/30", "label": "", "port_label": "e0/1 - e0/1", "title": "10.0.0.12/30\n10.0.0.13 \u003c-\u003e 10.0.0.14", "to": "3"}, {"from": "2", "ip_label": "172.16.0.8/30", "label": "", "port_label": "e0/2 - e0/0", "title": "172.16.0.8/30\n172.16.0.9 \u003c-\u003e 172.16.0.10", "to": "6"}, {"from": "4", "ip_label": "172.16.0.12/30", "label": "", "port_label": "e0/1 - e0/0", "title": "172.16.0.12/30\n172.16.0.13 \u003c-\u003e 172.16.0.14", "to": "7"}, {"from": "5", "ip_label": "172.16.0.16/30", "label": "", "port_label": "e0/1 - e0/0", "title": "172.16.0.16/30\n172.16.0.17 \u003c-\u003e 172.16.0.18", "to": "10"}, {"from": "6", "ip_label": "172.16.0.20/30", "label": "", "port_label": "e0/1 - e0/0", "title": "172.16.0.20/30\n172.16.0.21 \u003c-\u003e 172.16.0.22", "to": "13"}, {"from": "7", "ip_label": "172.16.0.24/30", "label": "", "port_label": "e0/1 - e0/0", "title": "172.16.0.24/30\n172.16.0.25 \u003c-\u003e 172.16.0.26", "to": "8"}, {"from": "8", "ip_label": "192.168.0.0/24", "label": "", "port_label": "e0/1 - e0/0", "title": "192.168.0.0/24\n192.168.0.1 \u003c-\u003e 192.168.0.2", "to": "9"}, {"from": "10", "ip_label": "172.16.0.28/30", "label": "", "port_label": "e0/1 - e0/0", "title": "172.16.0.28/30\n172.16.0.29 \u003c-\u003e 172.16.0.30", "to": "11"}, {"from": "11", "ip_label": "192.168.1.0/24", "label": "", "port_label": "e0/1 - e0/0", "title": "192.168.1.0/24\n192.168.1.1 \u003c-\u003e 192.168.1.2", "to": "12"}, {"from": "13", "ip_label": "172.16.0.32/30", "label": "", "port_label": "e0/1 - e0/0", "title": "172.16.0.32/30\n172.16.0.33 \u003c-\u003e 172.16.0.34", "to": "14"}, {"from": "14", "ip_label": "192.168.2.0/24", "label": "", "port_label": "e0/1 - e0/0", "title": "192.168.2.0/24\n192.168.2.1 \u003c-\u003e 192.168.2.2", "to": "15"}, {"from": "14", "ip_label": "192.168.2.0/24", "label": "", "port_label": "e0/2 - e0/0", "title": "192.168.2.0/24\n192.168.2.1 \u003c-\u003e 192.168.2.3", "to": "16"}, {"from": "14", "ip_label": "192.168.2.0/24", "label": "", "port_label": "e0/3 - e0/0", "title": "192.168.2.0/24\n192.168.2.1 \u003c-\u003e 192.168.2.4", "to": "17"}, {"from": "14", "ip_label": "192.168.2.0/24", "label": "", "port_label": "e0/4 - e0/0", "title": "192.168.2.0/24\n192.168.2.1 \u003c-\u003e 192.168.2.5", "to": "18"}]);

                  nodeColors = {};
                  allNodes = nodes.get({ returnType: "Object" });
                  for (nodeId in allNodes) {
                    nodeColors[nodeId] = allNodes[nodeId].color;
                  }
                  allEdges = edges.get({ returnType: "Object" });
                  // adding nodes and edges to the graph
                  data = {nodes: nodes, edges: edges};

                  var options = {
    "configure": {
        "enabled": false
    },
    "edges": {
        "color": {
            "inherit": true
        },
        "smooth": {
            "enabled": true,
            "type": "dynamic"
        }
    },
    "interaction": {
        "dragNodes": true,
        "hideEdgesOnDrag": false,
        "hideNodesOnDrag": false
    },
    "physics": {
        "enabled": true,
        "forceAtlas2Based": {
            "avoidOverlap": 0,
            "centralGravity": 0.01,
            "damping": 0.4,
            "gravitationalConstant": -50,
            "springConstant": 0.08,
            "springLength": 100
        },
        "solver": "forceAtlas2Based",
        "stabilization": {
            "enabled": true,
            "fit": true,
            "iterations": 1000,
            "onlyDynamicEdges": false,
            "updateInterval": 50
        }
    }
};

                  


                  

                  network = new vis.Network(container, data, options);

                  

                  

                  


                  

                  return network;

              }
              drawGraph();
        </script>
    
<canvas id="shapeCanvas" style="position:absolute;top:0;left:0;display:none;z-index:500;cursor:crosshair;"></canvas>
<div style="position:fixed;top:8px;right:8px;z-index:9999;background:#fff;border:1px solid #ccc;padding:8px;border-radius:6px;font-family:Arial,Helvetica,sans-serif;font-size:13px;">
  <label><input type="checkbox" id="toggleNames"> Show Names</label><br>
  <label><input type="checkbox" id="toggleIPs"> Show IPs</label><br>
  <label><input type="checkbox" id="togglePorts"> Show Ports</label><br>
  <hr style="margin:6px 0;">
  <label>Color: <input type="color" id="shapeColor" value="#FF0000"></label><br>
  <button id="drawRect" style="width:100%;padding:4px;background:#e0e0e0;border:1px solid #999;cursor:pointer;margin-top:4px;">Rectangle</button><br>
  <button id="drawCircle" style="width:100%;padding:4px;margin-top:4px;background:#e0e0e0;border:1px solid #999;cursor:pointer;">Circle</button><br>
  <button id="clearShapes" style="width:100%;padding:4px;margin-top:4px;background:#e0e0e0;border:1px solid #999;cursor:pointer;">Clear Shapes</button>
</div>
<script type="text/javascript">
  let drawingMode = null;
  let isDrawing = false;
  let startX, startY;
  const canvas = document.getElementById('shapeCanvas');
  const ctx = canvas ? canvas.getContext('2d') : null;
  const shapes = [];
  let tempShape = null;
  let shapeColor = '#FF0000';
  
  function initCanvas() {
    if (!canvas) return;
    const networkCanvas = document.querySelector('canvas');
    if (networkCanvas) {
      canvas.width = networkCanvas.width;
      canvas.height = networkCanvas.height;
    }
  }
  
  function setDrawingMode(mode) {
    drawingMode = mode;
    const btnRect = document.getElementById('drawRect');
    const btnCircle = document.getElementById('drawCircle');
    if (btnRect) btnRect.style.background = mode === 'rect' ? '#90EE90' : '#e0e0e0';
    if (btnCircle) btnCircle.style.background = mode === 'circle' ? '#90EE90' : '#e0e0e0';
    
    if (canvas) {
      canvas.style.display = mode ? 'block' : 'none';
    }
  }
  
  function hexToRgba(hex, alpha) {
    const r = parseInt(hex.slice(1, 3), 16);
    const g = parseInt(hex.slice(3, 5), 16);
    const b = parseInt(hex.slice(5, 7), 16);
    return `rgba(${r}, ${g}, ${b}, ${alpha})`;
  }
  
  function redrawShapes() {
    if (!ctx) return;
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    for (let shape of shapes) {
      if (shape.type === 'rect') {
        const w = shape.x2 - shape.x1;
        const h = shape.y2 - shape.y1;
        ctx.strokeStyle = shape.color;
        ctx.lineWidth = 2;
        ctx.fillStyle = hexToRgba(shape.color, 0.1);
        ctx.fillRect(shape.x1, shape.y1, w, h);
        ctx.strokeRect(shape.x1, shape.y1, w, h);
      } else if (shape.type === 'circle') {
        const r = Math.sqrt(Math.pow(shape.x2 - shape.x1, 2) + Math.pow(shape.y2 - shape.y1, 2));
        ctx.strokeStyle = shape.color;
        ctx.lineWidth = 2;
        ctx.fillStyle = hexToRgba(shape.color, 0.1);
        ctx.beginPath();
        ctx.arc(shape.x1, shape.y1, r, 0, 2 * Math.PI);
        ctx.fill();
        ctx.stroke();
      }
    }
    
    if (tempShape && drawingMode) {
      if (tempShape.type === 'rect') {
        const w = tempShape.x2 - tempShape.x1;
        const h = tempShape.y2 - tempShape.y1;
        ctx.strokeStyle = shapeColor;
        ctx.lineWidth = 2;
        ctx.fillStyle = hexToRgba(shapeColor, 0.2);
        ctx.fillRect(tempShape.x1, tempShape.y1, w, h);
        ctx.strokeRect(tempShape.x1, tempShape.y1, w, h);
      } else if (tempShape.type === 'circle') {
        const r = Math.sqrt(Math.pow(tempShape.x2 - tempShape.x1, 2) + Math.pow(tempShape.y2 - tempShape.y1, 2));
        ctx.strokeStyle = shapeColor;
        ctx.lineWidth = 2;
        ctx.fillStyle = hexToRgba(shapeColor, 0.2);
        ctx.beginPath();
        ctx.arc(tempShape.x1, tempShape.y1, r, 0, 2 * Math.PI);
        ctx.fill();
        ctx.stroke();
      }
    }
  }

  function setNameLabels(show){
    try{
      var nodes = network.body.data.nodes.get({returnType: "Array"});
      nodes.forEach(function(n){
        n.label = show ? (n.name || '') : '';
      });
      network.body.data.nodes.update(nodes);
      network.emit("_change");
      network.fit();
    }catch(e){console.error('Error in setNameLabels:', e)}
  }
  
  function setIPLabels(show){
    try{
      var edges = network.body.data.edges.get({returnType: "Array"});
      edges.forEach(function(e){
        e.label = show ? (e.ip_label || '') : '';
      });
      network.body.data.edges.clear();
      network.body.data.edges.add(edges);
      network.emit("_change");
      network.fit();
    }catch(e){console.error('Error in setIPLabels:', e)}
  }
  
  function setPortLabels(show){
    try{
      var edges = network.body.data.edges.get({returnType: "Array"});
      edges.forEach(function(e){
        e.label = show ? (e.port_label || '') : '';
      });
      network.body.data.edges.clear();
      network.body.data.edges.add(edges);
      network.emit("_change");
      network.fit();
    }catch(e){console.error('Error in setPortLabels:', e)}
  }
  
  document.addEventListener('DOMContentLoaded', function(){
    setTimeout(function(){
      initCanvas();
      
      var cbNames = document.getElementById('toggleNames');
      var cbIPs = document.getElementById('toggleIPs');
      var cbPorts = document.getElementById('togglePorts');
      var btnRect = document.getElementById('drawRect');
      var btnCircle = document.getElementById('drawCircle');
      var btnClear = document.getElementById('clearShapes');
      var colorInput = document.getElementById('shapeColor');
      
      if(cbNames){
        cbNames.addEventListener('change', function(ev){
          setNameLabels(ev.target.checked);
        });
      }
      if(cbIPs){
        cbIPs.addEventListener('change', function(ev){
          setIPLabels(ev.target.checked);
        });
      }
      if(cbPorts){
        cbPorts.addEventListener('change', function(ev){
          setPortLabels(ev.target.checked);
        });
      }
      
      if(colorInput){
        colorInput.addEventListener('change', function(ev){
          shapeColor = ev.target.value;
          redrawShapes();
        });
      }
      
      if(btnRect) {
        btnRect.addEventListener('click', function() {
          setDrawingMode(drawingMode === 'rect' ? null : 'rect');
        });
      }
      
      if(btnCircle) {
        btnCircle.addEventListener('click', function() {
          setDrawingMode(drawingMode === 'circle' ? null : 'circle');
        });
      }
      
      if(btnClear) {
        btnClear.addEventListener('click', function() {
          shapes.length = 0;
          redrawShapes();
        });
      }
      
      if(canvas) {
        canvas.addEventListener('mousedown', function(e) {
          if (!drawingMode) return;
          isDrawing = true;
          startX = e.clientX - canvas.getBoundingClientRect().left;
          startY = e.clientY - canvas.getBoundingClientRect().top;
        });
        
        canvas.addEventListener('mousemove', function(e) {
          if (!isDrawing || !drawingMode) return;
          const rect = canvas.getBoundingClientRect();
          tempShape = {
            type: drawingMode,
            x1: startX,
            y1: startY,
            x2: e.clientX - rect.left,
            y2: e.clientY - rect.top
          };
          redrawShapes();
        });
        
        canvas.addEventListener('mouseup', function(e) {
          if (!isDrawing || !drawingMode) return;
          const rect = canvas.getBoundingClientRect();
          const x2 = e.clientX - rect.left;
          const y2 = e.clientY - rect.top;
          const dx = x2 - startX;
          const dy = y2 - startY;
          const distance = Math.sqrt(dx * dx + dy * dy);
          
          if (distance > 5) {
            shapes.push({
              type: drawingMode,
              x1: startX,
              y1: startY,
              x2: x2,
              y2: y2,
              color: shapeColor
            });
          }
          isDrawing = false;
          tempShape = null;
          redrawShapes();
        });
      }
    }, 500);
  });
</script>

</body>
</html>